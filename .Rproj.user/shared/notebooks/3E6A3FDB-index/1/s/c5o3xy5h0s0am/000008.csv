"0",""
"0","imputar_datos <- recipe(~ International_calls + International_charges, data = data_churn) %>% "
"0","  step_meanimpute(International_charges) %>% "
"0","  step_knnimpute( all_predictors())  "
"0",""
"0","datos_imputados_knn <- prep(imputar_datos) %>% "
"0","  juice()"
"0",""
"0","imputar_mco <- lm(International_charges ~ International_calls, "
"0","                  data = data_churn)"
"0",""
"0"," "
"0","pred <- predict(imputar_mco , newdata =  data_churn)"
"0"," "
"0","datos_imputados_mco <- data_churn %>% "
"0","  mutate(missing = ifelse(is.na(International_charges), 0, 1),"
"0","         int_calls = ifelse(is.na(International_calls), 0, "
"0","                              International_calls),"
"0","         International_charges1 = International_charges)  %>% "
"0","  select(missing, International_charges, International_calls, int_calls,"
"0","         International_charges1)"
"0","  "
"0"," "
"0","for(i in 1:nrow(datos_imputados_mco))"
"0","{"
"0","  if(datos_imputados_mco$missing[i] == 0)"
"0","  {"
"0","    datos_imputados_mco$International_charges1[i] = imputar_mco$coefficients[1] + "
"0","      imputar_mco$coefficients[2]*datos_imputados_mco$int_calls[i]"
"0","  }"
"0","}"
"0",""
"0"," "
"0"," "
"0","# Verificar media de los datos imputados vs los datos reales"
"0","summary(datos_imputados_knn[1])"
"1",""
"1"," International_calls"
"1","
"
"1"," Min.   : 0.000     "
"1","
"
"1"," 1st Qu.: 3.000     "
"1","
"
"1"," Median : 4.000     "
"1","
"
"1"," Mean   : 4.485     "
"1","
"
"1"," 3rd Qu.: 6.000     "
"1","
"
"1"," Max.   :20.000     "
"1","
"
"0","summary(datos_imputados_mco[5])"
"1",""
"1"," International_charges1"
"1","
"
"1"," Min.   :0.000         "
"1","
"
"1"," 1st Qu.:2.300         "
"1","
"
"1"," Median :2.780         "
"1","
"
"1"," Mean   :2.769         "
"1","
"
"1"," 3rd Qu.:3.240         "
"1","
"
"1"," Max.   :5.100         "
"1","
"
"0","summary(data_churn$Total.intl.calls)"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  0.000 "
"1","  3.000 "
"1","  4.000 "
"1","  4.479 "
"1","  6.000 "
"1"," 20.000 "
"1","
"
"0","summary(data_churn$Total.intl.charge)"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  0.000 "
"1","  2.300 "
"1","  2.780 "
"1","  2.765 "
"1","  3.270 "
"1","  5.400 "
"1","
"
"0","datos_imputados <- "
"0","  data.frame(International_calls1 = datos_imputados_knn$International_calls,"
"0","            International_charges1 = datos_imputados_mco$International_charges1)"
"0"," "
"0","# Verificar los valores imputados vs los valores reales"
"0"," "
"0","#data_churn %>% "
"0","#  bind_cols(datos_imputados) %>% "
"0","#  filter(is.na(International_calls) | is.na(International_charges)) %>% "
"0","#  select(International_calls, International_charges,"
"0","#         Total.intl.calls, International_calls1,"
"0","#         Total.intl.charge, International_charges1)"
